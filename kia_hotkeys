SetTitleMatchMode, 2
CoordMode, Mouse, Screen

global GuiTitle := ""
global ActionSelection := ""

global Dwell := 500
global TemplateCatagoryDropDownMenu := {x: 950, y: 396, sleepTime:500}
global PersonalTemplateButton := {x: 920, y:465, sleepTime:500}
global TemplateDropDownMenu:= {x:1100,y:400, sleepTime:500}
global TemplateSelection1:= {x:1100, y:445, sleepTime:1500}
global TemplateSelection2:= {x: 1100, y:460, sleepTime:1500}
global TemplateSelection3:= {x: 1100, y: 480, sleepTime:1500}
global TemplateSelection4:= {x: 1100, y:500, sleepTime:1500}
global TemplateSelection5:= {x: 1100, y:565, sleepTime:1500}
global TemplateSelection6:= {x: 1100, y:585, sleepTime:1500}
global TemplateSelection7:= {x: 1100, y:600, sleepTime:1500}
global TemplateSelection8:= {x: 1100, y:644, sleepTime:1500}
global TemplateSelection9:= {x: 1100, y:681, sleepTime:1500}
global CallTabButton:= {x:660, y:350, sleepTime:250}
global EmailTabButton:= {x:765, y:350, sleepTime:1500}
global TextTabButton:= {x: 870, y: 350, sleepTime:250}
global OptInButton := {x:1183, y:525, sleepTime:500}
global CallButton := {x:1184 , y:411 , sleepTime:1000}
global RefreshSecondBrowserButton := {x:93, y:-1017 , sleepTime:2500}
global EndCallButton := {x:1170, y:120 , sleepTime:2000}
global CallOutcomeDropdownMenu := {x:830, y:419, sleepTime:500}
global CallOutcomeDidNotLeaveVoicemail := {x:830, y:499, sleepTime:250}
global LogCallButton := {x:1200, y:628, sleepTime:250}
global TextBoxTextArea := {x:536, y:401, sleepTime: 250}
global FirstName := {x:633, y:174, sleepTime:250}
global FirstNameUnderlineSpot := {x:650, y: 401, sleepTime:10}
global VehicleUnderlineSpot := {x:785, y: 425, sleepTime:10}
global EmailSendButton := {x:1184, y:938, sleepTime: 1000}
global TextSendButton := {x:1184, y:938, sleepTime: 100}
global SecondWindowCallOutcomeDropDownMenu := {x: 500,y: -667, sleepTime: 250}
global SecondWindowOutcomeLeftVoicemail := {x: 500,y: -602, sleepTime: 250}
global SecondWindowLogCall := {x: 876,y: -458, sleepTime: 0}
global TextTemplateButton := {x:1064, y:473, sleepTime: 1500}
global TextTemplateSelection1 := {x: 666,y: 525,sleepTime: 500}
global TextTemplateSelection2 := {x: 666,y: 555,sleepTime: 500}
global TextTemplateSelection3 := {x: 666,y: 605,sleepTime: 500}
global TextTemplateSelection5 := {x: 666,y: 733,sleepTime: 1000}
global TextTemplateSelectionConfirmationButton := {x: 1365,y: 810, sleepTime: 1500 }
global TextSendButton := {x:1183, y:467, sleepTime:1000}
global CancelFireAi := {x:1155, y:518, sleepTime:250}
global NotTextingNumber := {x:1167, y:423, sleepTime:250}
global ResendOptInTextButton := {x:1172, y:516, sleepTime:250}
global RemoveTaskConfirmation := {x:1129, y:643, sleepTime:100}
global TextNotAValidNumberClear := {x:1176, y:445, sleepTime:200}
global NextCustomerButton := {x:1644, y:535, sleepTime:1500}
global SearchForCustomer := {x:1620, y:115, sleepTime:250}
global SelectCustomerFromSearch := {x:1620, y:170, sleepTime: 500}
global ExitCustomerProfilePage := {x:1394, y:155, sleepTime: 500}


MoveClick(obj) {
    ; Extract relevant information from the object
    x := obj.x ; X-coordinate relative to the screen
    y := obj.y ; Y-coordinate relative to the screen
    sleepTime := obj.sleepTime
    MouseMove, % x, % y
    Sleep, 25
    Click
    Sleep, % sleepTime
}

MoveDoubleClick(obj){
    ; Extract relevant information from the object
    x := obj.x ; X-coordinate relative to the screen
    y := obj.y ; Y-coordinate relative to the screen
    sleepTime := obj.sleepTime 
    MouseMove, % x, % y
    Sleep, 5
    Click
    Click
    Sleep, % sleepTime
}

`::
    Gui, Destroy
    ActionSelection := ""
    GuiTitle := "Action Selector"
    ShowGui(GuiTitle)
    return

HandleActionSelection:
    Gui, Destroy
    Gosub, MainLoop

HandleEscape:
    Gui, Destroy
    return

MainLoop:
    Gui, Destroy
    MouseGetPos, xOrigin, yOrigin
    if(ActionSelection = "Quick Call"){
        MoveClick(CallTabButton)
        MoveClick(CallButton)
        MoveClick(RefreshSecondBrowserButton)
        MoveClick(EndCallButton)
        MoveClick(CallOutcomeDropdownMenu)
        MoveClick(CallOutcomeDidNotLeaveVoicemail)
        MoveClick(LogCallButton)
    } else if (ActionSelection = "Email - New Inquiry") {
        MoveClick(EmailTabButton)
        MoveClick(TemplateCatagoryDropDownMenu)
        MoveClick(PersonalTemplateButton)
        MoveClick(TemplateDropDownMenu)
        MoveClick(TemplateSelection1)
    } else if (ActionSelection = "Text - Opt In" ){
        MoveClick(TextTabButton)
        MoveClick(OptInButton)
    } else if (ActionSelection = "Text - New Inquiry" ){
        MoveClick(TextTabButton)
        MoveClick(TextTemplateButton)
        MoveClick(TextTemplateSelection1)
        MoveClick(TextTemplateSelectionConfirmationButton)
        MoveClick(TextSendButton)
    } else if (ActionSelection = "Email - Follow Up") {
        MoveClick(EmailTabButton)
        MoveClick(TemplateCatagoryDropDownMenu)
        MoveClick(PersonalTemplateButton)
        MoveClick(TemplateDropDownMenu)
        MoveClick(TemplateSelection2)
    } else if (ActionSelection = "Text - Follow Up") {
        MoveClick(TextTabButton)
        MoveClick(TextTemplateButton)
        MoveClick(TextTemplateSelection2)
        MoveClick(TextTemplateSelectionConfirmationButton)
        MoveClick(TextSendButton)
    } else if (ActionSelection = "Email - Trade In") {
        MoveClick(EmailTabButton)
        MoveClick(TemplateCatagoryDropDownMenu)
        MoveClick(PersonalTemplateButton)
        MoveClick(TemplateDropDownMenu)
        MoveClick(TemplateSelection3)
    } else if (ActionSelection = "Text - Trade In") {
        MoveClick(TextTabButton)
        MoveClick(TextBoxTextArea)
        filePathSubject := "C:\Users\jfadelli\Desktop\AHK\txt files\texts\trade_in_text.txt"
        fileSubject := FileOpen(filePathSubject, "r")
        if (fileSubject)
        {
            fileSubjectContents := fileSubject.Read()
            fileSubject.Close()
            clipboard := fileSubjectContents
        }
        else
        {
            MsgBox, Failed to open the subject file., 100
        }
        send, ^v
        MoveDoubleClick(FirstName)
        send, ^c
        MoveDoubleClick(FirstNameUnderlineSpot)
        send, ^v
        send, {Backspace}
        sleep, 10
        MoveDoubleClick(VehicleUnderlineSpot)

    } else if (ActionSelection = "Email - Mining") {
        MoveClick(EmailTabButton)
        MoveClick(TemplateCatagoryDropDownMenu)
        MoveClick(PersonalTemplateButton)
        MoveClick(TemplateDropDownMenu)
        MoveClick(TemplateSelection5)
    }
    MouseMove, %xOrigin%, %yOrigin%, 0
        return
    
    return

ShowGUI(GuiTitle) {
    if (GuiTitle = "Action Selector") {
        Gui +ToolWindow +AlwaysOnTop
        Gui, Add, Text,, Select an option:
        Gui, Add, Text, , Press 1 for Quick Call
        Gui, Add, Text, , Press 2 for Email - New Inquiry
        Gui, Add, Text, , Press 3 for Text - Opt In
        Gui, Add, Text, , Press 3 for Text - New Inquiry
        Gui, Add, Text, , ---------------------------------
        Gui, Add, Text, , Press 4 for Email - Follow Up
        Gui, Add, Text, , Press 5 for Text - Follow Up
        Gui, Add, Text, , ---------------------------------
        Gui, Add, Text, , Press 6 for Email - Trade In
        Gui, Add, Text, , Press 7 for Text - Trade In
        Gui, Add, Text, , ---------------------------------
        Gui, Add, Text, , Press 8 for Email - Mining
        Gui, Add, Button, Hidden w0 h0 Default gHandleActionSelection, Save
    } 
    Gui, Show, w300 h400, %GuiTitle%
    return
}

#IfWinActive, Action Selector
1:: ActionSelection := "Quick Call", Gosub, HandleActionSelection
2:: ActionSelection := "Email - New Inquiry", Gosub, HandleActionSelection
3:: ActionSelection := "Text - Opt In", Gosub, HandleActionSelection
+3:: ActionSelection := "Text - New Inquiry", Gosub, HandleActionSelection
4:: ActionSelection := "Email - Follow Up", Gosub, HandleActionSelection
5:: ActionSelection := "Text - Follow Up", Gosub, HandleActionSelection
6:: ActionSelection := "Email - Trade In", Gosub, HandleActionSelection
7:: ActionSelection := "Text - Trade In", Gosub, HandleActionSelection
8:: ActionSelection := "Email - Mining", Gosub, HandleActionSelection

Escape:: Gosub, HandleEscape
#IfWinActive

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Launch New Chrome Window
^!t:: Run, chrome.exe

; Misc Hotkeys

; Text Loop
#`::
; Path to the text file containing the names
counter := 0
filePath := "C:\Users\jfadelli\Desktop\AHK\txt files\names\names2.txt"
; Open the file for reading
FileRead, fileContent, %filePath%
; Split the file content into lines (names)
Loop, parse, fileContent, `n, `r
{
    counter ++ 1
    currentName := A_LoopField
    ; Trim any extra whitespace from the name
    currentName := Trim(currentName)
    
    MoveClick(SearchForCustomer)
    Send, ^a
    Send, {Backspace}
    Sleep, 50
    Send, %currentName%
    Sleep, 750
    MoveClick(SelectCustomerFromSearch)
    MoveClick(TextTabButton)
    MoveClick(TextTemplateButton)
    MoveClick(TextTemplateSelection5)
    MoveClick(TextTemplateSelectionConfirmationButton)
    MoveClick(TextSendButton)
    MoveClick(ExitCustomerProfilePage)
    if (mod(counter, 5) == 0)
        {
            MsgBox, 4, , Reached 5 cycles. Continue? (Yes/No)
            IfMsgBox, No
                break  ; Stop the loop if 'No' is clicmod(counter,
        }
}

return

; Email loop 2.0
+#`::
; Path to the text file containing the names
filePath := "C:\Users\jfadelli\Desktop\AHK\txt files\names\names.txt"
; Open the file for reading
FileRead, fileContent, %filePath%
; Split the file content into lines (names)
Loop, parse, fileContent, `n, `r
{
    currentName := A_LoopField
    ; Trim any extra whitespace from the name
    currentName := Trim(currentName)
    
    MoveClick(SearchForCustomer)
    Send, ^a
    Send, {Backspace}
    Sleep, 50
    Send, %currentName%
    Sleep, 750
    MoveClick(SelectCustomerFromSearch)
    MoveClick(EmailTabButton)
    MoveClick(TemplateCatagoryDropDownMenu)
    MoveClick(PersonalTemplateButton)
    MoveClick(TemplateDropDownMenu)
    MoveClick(TemplateSelection9)
    MoveClick(EmailSendButton)
    MoveClick(ExitCustomerProfilePage)
}
return

+F5::
    ; Check if Chrome is active
    IfWinNotExist, Google Sheets
    {
        ; If Chrome is not active, activate it and open a new tab with the specified URL
        Run, chrome.exe "https://sheets.google.com"
        WinWait, Google Sheets
    }
    else
    {
        ; If Chrome is already active, open a new tab with the specified URL
        WinActivate, Google
        Send, ^t
        Sleep, 100
        Send, https://sheets.google.com
    }
return

+F4::
    ; Check if Chrome is active
    IfWinNotExist, Google Docs
    {
        ; If Chrome is not active, activate it and open a new tab with the specified URL
        Run, chrome.exe "https://docs.google.com"
        WinWait, Google Docs
    }
    else
    {
        ; If Chrome is already active, open a new tab with the specified URL
        WinActivate, Google
        Send, ^t
        Sleep, 100
        Send, https://docs.google.com
    }
return

PgDn::
    ; Check if Chrome is active
    WinActivate, ahk_exe chrome.exe
    Sleep, 700

    ; Activate the tab with the specified title
    WinActivate, Home / DriveCentric
    Sleep, 700

    ; Additional mouse actions after opening the Shift+F3 URL
    MouseMove, 33, 225
    SendEvent {Click}
    Sleep, 300
    MouseMove, 360, 225
    SendEvent {Click}
return

#Right::
    CoordMode, mouse, Screen
    MouseGetPos, xOrigin, yOrigin
    MouseMove, 1644, 529, 0
    SendEvent, {Click}
    Sleep, 5
    MouseMove, %xOrigin%, %yOrigin%, 0
    CoordMode, Mouse, Window
return

#Left::
    CoordMode, mouse, Screen
    MouseGetPos, xOrigin, yOrigin
    MouseMove, 276, 529, 0
    SendEvent, {Click}
    Sleep, 5
    MouseMove, %xOrigin%, %yOrigin%, 0
    CoordMode, Mouse, Window
return


#u::
    ; Copy currently selected text to clipboard
    Send, ^c
    ClipWait
    
    ; Get the clipboard content
    ClipboardContent := Clipboard
    
    ; If there's text in the clipboard
    if (ClipboardContent != "") {
        ; Open new Chrome tab with the specified URL
        Run, chrome.exe "https://www.premierkiaofcarlsbad.com/used-vehicles/?q="%ClipboardContent%"&_dFR%5Btype%5D%5B0%5D=Used",, UseErrorLevel
        ; Check for errors
        if ErrorLevel
            MsgBox, Error opening Chrome tab.
    } else {
        MsgBox, No text selected to use in the URL.
    }
return

#n::
    ; Copy currently selected text to clipboard
    Send, ^c
    ClipWait
    
    ; Get the clipboard content
    ClipboardContent := Clipboard
    
    ; If there's text in the clipboard
    if (ClipboardContent != "") {
        ; Open new Chrome tab with the specified URL
        Run, chrome.exe "https://www.premierkiaofcarlsbad.com/new-vehicles/?q="%ClipboardContent%"&_dFR%5Btype%5D%5B0%5D=New",, UseErrorLevel
        ; Check for errors
        if ErrorLevel
            MsgBox, Error opening Chrome tab.
    } else {
        MsgBox, No text selected to use in the URL.
    }
return

^#w:: ; Wishlist
    Run, chrome.exe "https://docs.google.com/spreadsheets/d/1ky3eBpprlqT-PRmj6WgcM7yrUjQLpl0SRuzP3uvJMro/edit#gid=0"
return


;get monroney
; Hotkey to trigger the input box
^#v::  ; win + ctrl + v as the hotkey.
InputBox, vin, Enter VIN, Please enter the VIN:
if ErrorLevel  ; Checks if the user pressed Cancel.
{
    MsgBox, You cancelled.
}
else
{
    url := "https://get-monroney-server-43d02c80534a.herokuapp.com/getMonroney/" . vin
    Run, chrome.exe %url%
}
return

^#n:: ; New Cars
    Run, chrome.exe "https://www.premierkiaofcarlsbad.com/new-vehicles/"
return


^#u:: ;Used carsv
    Run, chrome.exe "https://www.premierkiaofcarlsbad.com/used-vehicles/"
return

^#r:: ;Recon
    Run, chrome.exe "https://app2.reconvelocity.com/login"
return

^#k:: ;Kdealer
    Run, chrome.exe "https://www.kdealer.com/commonDashboard"
return 

; 
#c:: ;Costco Auto Program
    Run, chrome.exe "https://dealers.costcoauto.com/" ;
return

>!n::  ; This is the hotkey for Right Alt + N
    Send, 760.496.3140 
return

>!j::  ; This is the hotkey for Right Alt + J
    Send, Jason 
return


#LButton::
MouseGetPos, xOrigin, yOrigin
Send, {Click}
Sleep, 100
MoveClick(RemoveTaskConfirmation)
MouseMove, %xOrigin%, %yOrigin%
return


#Enter::
MouseGetPos, xOrigin, yOrigin
MoveClick(EmailSendButton)
MouseMove, %xOrigin%, %yOrigin%
return

>^Enter::
MouseGetPos, xOrigin, yOrigin
MoveClick(EmailSendButton)
MouseMove, %xOrigin%, %yOrigin%
return

^#Enter::
MouseGetPos, xOrigin, yOrigin
MoveClick(ResendOptInTextButton)
MouseMove, %xOrigin%, %yOrigin%
return


#v::
    MouseGetPos, xOrigin, yOrigin
    MoveClick(SecondWindowCallOutcomeDropDownMenu)
    MoveClick(SecondWindowOutcomeLeftVoicemail)
    MoveClick(SecondWindowLogCall)
    MouseMove, %xOrigin%, %yOrigin%
return 

; ; Remap Control + XButton1 to copy
; ^XButton1::
;     Send, ^c
;     return

; ; Remap Control + XButton2 to paste
; ^XButton2::
;     Send, ^v
;     return

; USED CAR CUSTOMERS
; ////////////////////////////////////////////////////
; XButton2::
    ; Send, ^w
    ; return

; ; XButton1:: 
;     Send, {Click}
;     ClipWait
;     ClipboardContent := Clipboard
;     if (ClipboardContent != "") {
;         ; Open new Chrome tab with the specified URL
;         Run, chrome.exe "https://www.premierkiaofcarlsbad.com/inventory?keyword="%ClipboardContent%"&submit=Submit&type=used",, UseErrorLevel
;         ; Check for errors
;         if ErrorLevel
;             MsgBox, Error opening Chrome tab.
;     } else {
;         MsgBox, No text selected to use in the URL.
;     }
;     return
; /////////////////////////////////////////////////////////
F1::
Click 1190, 402
Sleep, 2500
Click 1184, 113
Sleep, 1500
Click 891, 407
Sleep, 250
Click 767, 492
Sleep, 250
Click 1200, 607

F2:: 
CoordMode, mouse, Screen
MouseGetPos, xOrigin, yOrigin
MouseMove, 1644, 529, 0
SendEvent, {Click}
Sleep, 5
MouseMove, %xOrigin%, %yOrigin%, 0
CoordMode, Mouse, Window
Return
